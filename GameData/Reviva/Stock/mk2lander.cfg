// Mk2 Lander IVA:
// - Stock
// - RPM
// - DE_IVAExtension
// - DE+MAS
@PART[mk2LanderCabin_v2]:NEEDS[RasterPropMonitor]:BEFORE[zzz_Reviva]
{
	// Remove all RasterPropMonitor and add just one empty one
	// Each sub-type will fill in contents as required
	-MODULE[RasterPropMonitorComputer],* {}
	MODULE
	{
		name = RasterPropMonitorComputer
	}
}

@PART[mk2LanderCabin_v2]:HAS[!MODULE[MASFlightComputer]]:NEEDS[DE_IVAExtension&AvionicsSystems]:FOR[zzz_Reviva]
{
	MODULE
	{
		name = MASFlightComputer
		requiresPower = true
		gLimit = 4.7
		baseDisruptionChance = 0.20
	}
}

@PART[mk2LanderCabin_v2]:FOR[zzz_Reviva]
{
	@INTERNAL
	{
		@name = mk2LanderCanInternal
	}

	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = IVASwitch
		switcherDescription = IVA
		switcherDescriptionPlural = IVAs
		switchInFlight = true
		uiGroupName = IVASwitch
		uiGroupDisplayName = IVA Switch
		
		SUBTYPE
		{
			name = Stock
			primaryColor = White
			secondaryColor = White
			descriptionSummary = Stock IVA
			descriptionDetail = Use the Stock IVA.\n<color=green>Low Tech</color>
			
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleIVASwitch
				}
				DATA
				{
					internalName = mk2LanderCanInternal
				}
			}
		}

		SUBTYPE:NEEDS[JSI/RPMPodPatches/PatchesStock]
		{
			name = RPM
			primaryColor = Blue
			secondaryColor = White
			descriptionSummary = RPM IVA
			descriptionDetail = Use RPM provided IVA, using JSI props.\n<color=green>Medium Tech Digital</color>
			
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleIVASwitch
				}
				DATA
				{
					internalName = landerCabinInternalsRPM
				}
			}
		}

		SUBTYPE:NEEDS[DE_IVAExtension&AvionicsSystems]
		{
			name = DE+MAS
			primaryColor = Red
			secondaryColor = Avocado // Avacadonics
			descriptionSummary = DE+MAS IVA
			descriptionDetail = Use DE IVAExtension IVA with MAS MFD upgrades.\n<color=green>Near Future Digital</color>
			
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleIVASwitch
				}
				
				DATA
				{
					internalName = DE_mk2LanderCanInternal_MAS
					RasterPropMonitorComputer
					{
						%storedStrings = #$/DE_IVA_storedStrings$
						%triggeredEvents = #$/DE_IVA_triggeredEvents$
					}
				}
			}
		}
	}

	MODULE
	{
		name = ModuleIVASwitch
		internalName = mk2LanderCanInternal
	}
}

// Provides alternate DE+MAS IVA upgrade
+INTERNAL[DE_mk2LanderCanInternal]:NEEDS[DE_IVAExtension&AvionicsSystems]:FOR[zzz_Reviva]
{
	@name = DE_mk2LanderCanInternal_MAS

	@PROP[ALCORMFD40x20],0 // Left most is 1 in list
	{
		@name = MAS_ALCOR_MFD2

		@position[0] += 0.000
		@position[1] += 0.040
		@position[2] += 0.000

		@scale[*] *= 1.1
	}
}
