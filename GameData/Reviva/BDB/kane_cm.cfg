// BDB Kane Command Module
// - BDB
// - MASRetro (MAS, from MOARdVPlus)
// - MASGlass (MAS, from MOARdVPlus)
//
// These are also included because it's almost the same as the mk1-3 CM.
//
// - Stock (mk1-3)
// - RPM (mk1-3)
// - DE_IVAExtension (mk1-3)
// - ASET (mk1-3)
// - MAS (mk1-3)
// - DE+MAS (mk1-3)

@PART[bluedog_Apollo_CrewPod]:NEEDS[Bluedog_DB&B9PartSwitch&RasterPropMonitor]:BEFORE[zzz_Reviva]
{
	// Remove all RasterPropMonitor and add just one empty one
	// Each sub-type will fill in contents as required
	-MODULE[RasterPropMonitorComputer],* {}
	MODULE
	{
		name = RasterPropMonitorComputer
	}
}

@PART[bluedog_Apollo_CrewPod]:HAS[!MODULE[MASFlightComputer]]:NEEDS[Bluedog_DB&AvionicsSystems]:FOR[zzz_Reviva]
{
    MODULE
    {
        name = MASFlightComputer
        requiresPower = true
        gLimit = 4.7
        baseDisruptionChance = 0.20
    }
}

@PART[bluedog_Apollo_CrewPod]:NEEDS[Bluedog_DB&B9PartSwitch]:FOR[zzz_Reviva]
{
	@INTERNAL {
		@name = bdbKP0110internal
	}

	MODULE
	{
		name = ModuleB9PartSwitch
		moduleID = IVASwitch
		switcherDescription = IVA
		switcherDescriptionPlural = IVAs
		switchInFlight = true
		uiGroupName = IVASwitch
		uiGroupDisplayName = IVA Switch
		
		SUBTYPE
		{
			name = BDB
			primaryColor = Blue
			secondaryColor = Blue
			descriptionSummary = BDB IVA
			descriptionDetail = Use normal BDB Stock IVA.\n<color=green>Low Tech</color>
			
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleIVASwitch
				}
				DATA
				{
					internalName = bdbKP0110internal
				}
			}
		}

		SUBTYPE:NEEDS[AvionicsSystems]
		{
			name = MASRetro
			primaryColor = Green
			secondaryColor = Blue
			descriptionSummary = Retro IVA
			descriptionDetail = Use MOARdVPlus AvionicsSystems Retro IVA.\n<color=green>Low Tech Analog</color>
			
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleIVASwitch
				}
				DATA
				{
					internalName = FASA_Apollo_CM_Int
					MASFlightComputer
					{
						name = MASFlightComputer
						requiresPower = true
						gLimit = 4.7
						baseDisruptionChance = 0.20
						rate = 0.025

						RPM_COLOROVERRIDE
						{
							COLORDEFINITION
							{
								// 'white' label unlit color
								name = ASET_SWITCHER_NAME_ZEROCOLOR
								color =  213, 213, 213, 255
							}
							COLORDEFINITION
							{
								name = ASET_NUMINPUT_DISPLAY_GHOSTCOLOR
								color = 0, 255, 0, 31
							}
							COLORDEFINITION
							{
								name = ASET_NUMINPUT_DISPLAY_POSITIVECOLOR
								color = 0, 255, 0, 255
							}
							COLORDEFINITION
							{
								name = ASET_NUMINPUT_DISPLAY_NEGATIVECOLOR
								color = 0, 0, 0, 0
							}
						}

						MAS_ACTION_GROUP
						{
							name = Kane-11-LIB EVA Floodlight AG
							id = 10
							ACTION
							{
								name = Light
								part = bluedog_Apollo_Block2_DockingLight
								module = ModuleLight
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = Kane-11-DPM6 0.625m Active Docking Mechanism AG
							id = 11
							ACTION
							{
								name = Docking Probe
								part = bluedog_Apollo_Block2_ActiveDockingMechanism
								module = ModuleAnimateGeneric
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = Kane-11-FBL Docking Floodlight AG
							id = 12
							ACTION
							{
								name = Light
								part = bluedog_Apollo_Block2_DockingLight2
								module = ModuleLight
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = MdV_FASAApollo_CM RCS AG
							id = 13
							ACTION
							{
								name = RCS
								part = MdV_FASAApollo_CM
								module = ModuleRCS
								action = toggle
							}
							ACTION
							{
								name = RCS
								part = MdV_FASAApollo_CM_Glass
								module = ModuleRCS
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = Tower Jettison AG
							id = 14
							ACTION
							{
								name = jettison
								part = bluedog_Apollo_Block2_LES
								module = ModuleBdbLesController.DoJettison
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = SLA AG
							id = 15
							// Use the same switch for any SLA.
							ACTION
							{
								name = SLA 1
								part = bluedog_Saturn_S4B_SLA
								module = ModuleBdbDecouplerAnimation.Decouple
								action = on
							}
							ACTION
							{
								name = SLA 2
								part = bluedog_Saturn_S4B_SLAbase
								module = ModuleBdbSLAHelper.Decouple
								action = on
							}
							ACTION
							{
								name = SLA MM
								part = bluedog_Saturn_VFB_MissionModule
								module = ModuleDecouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = LEM release AG
							id = 16
							// Use the same switch for any SLA.
							ACTION
							{
								name = SLA 1
								part = bluedog_Saturn_S4B_SLA
								module = ModuleDecouple
								action = on
							}
							ACTION
							{
								name = SLA 2
								part = bluedog_Saturn_S4B_SLAbase
								module = ModuleDecouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = Parachute Cover AG
							id = 17
							ACTION
							{
								name = Jettison Cover
								part = MdV_FASAApollo_CM_Top
								module = ModuleDecouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = CM/SM Decouple AG
							id = 18
							ACTION
							{
								name = SM Separation
								part = bluedog_Apollo_Block2_Decoupler
								module = ModuleBdbDecouplerAnimation.Decouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = SM Cargo Bays AG
							id = 19
							ACTION
							{
								name = SM Cargo Bay
								part = bluedog_Apollo_Block2_ServiceModule
								module = ModuleAnimateGeneric
								action = toggle
							}
						}	
					}
				}
			}
		}

		SUBTYPE:NEEDS[AvionicsSystems]
		{
			name = MASGlass
			primaryColor = Red
			secondaryColor = Blue
			descriptionSummary = Modern IVA
			descriptionDetail = Use MOARdVPlus AvionicsSystems Modern Glass IVA.\n<color=green>High Tech</color>
			
			MODULE
			{
				IDENTIFIER
				{
					name = ModuleIVASwitch
				}
				DATA
				{
					internalName = FASA_Apollo_CM_Glass
					MASFlightComputer
					{
						name = MASFlightComputer
						requiresPower = true
						gLimit = 4.7
						baseDisruptionChance = 0.20
						rate = 0.025

						RPM_COLOROVERRIDE
						{
							COLORDEFINITION
							{
								// 'white' label unlit color
								name = ASET_SWITCHER_NAME_ZEROCOLOR
								color =  213, 213, 213, 255
							}
							COLORDEFINITION
							{
								name = ASET_NUMINPUT_DISPLAY_GHOSTCOLOR
								color = 0, 255, 0, 31
							}
							COLORDEFINITION
							{
								name = ASET_NUMINPUT_DISPLAY_POSITIVECOLOR
								color = 0, 255, 0, 255
							}
							COLORDEFINITION
							{
								name = ASET_NUMINPUT_DISPLAY_NEGATIVECOLOR
								color = 0, 0, 0, 0
							}
						}

						MAS_ACTION_GROUP
						{
							name = Kane-11-LIB EVA Floodlight AG
							id = 10
							ACTION
							{
								name = Light
								part = bluedog_Apollo_Block2_DockingLight
								module = ModuleLight
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = Kane-11-DPM6 0.625m Active Docking Mechanism AG
							id = 11
							ACTION
							{
								name = Docking Probe
								part = bluedog_Apollo_Block2_ActiveDockingMechanism
								module = ModuleAnimateGeneric
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = Kane-11-FBL Docking Floodlight AG
							id = 12
							ACTION
							{
								name = Light
								part = bluedog_Apollo_Block2_DockingLight2
								module = ModuleLight
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = MdV_FASAApollo_CM RCS AG
							id = 13
							ACTION
							{
								name = RCS
								part = MdV_FASAApollo_CM
								module = ModuleRCS
								action = toggle
							}
							ACTION
							{
								name = RCS
								part = MdV_FASAApollo_CM_Glass
								module = ModuleRCS
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = Tower Jettison AG
							id = 14
							ACTION
							{
								name = jettison
								part = bluedog_Apollo_Block2_LES
								module = ModuleBdbLesController.DoJettison
								action = toggle
							}
						}
						MAS_ACTION_GROUP
						{
							name = SLA AG
							id = 15
							// Use the same switch for any SLA.
							ACTION
							{
								name = SLA 1
								part = bluedog_Saturn_S4B_SLA
								module = ModuleBdbDecouplerAnimation.Decouple
								action = on
							}
							ACTION
							{
								name = SLA 2
								part = bluedog_Saturn_S4B_SLAbase
								module = ModuleBdbSLAHelper.Decouple
								action = on
							}
							ACTION
							{
								name = SLA MM
								part = bluedog_Saturn_VFB_MissionModule
								module = ModuleDecouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = LEM release AG
							id = 16
							// Use the same switch for any SLA.
							ACTION
							{
								name = SLA 1
								part = bluedog_Saturn_S4B_SLA
								module = ModuleDecouple
								action = on
							}
							ACTION
							{
								name = SLA 2
								part = bluedog_Saturn_S4B_SLAbase
								module = ModuleDecouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = Parachute Cover AG
							id = 17
							ACTION
							{
								name = Jettison Cover
								part = MdV_FASAApollo_CM_Top
								module = ModuleDecouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = CM/SM Decouple AG
							id = 18
							ACTION
							{
								name = SM Separation
								part = bluedog_Apollo_Block2_Decoupler
								module = ModuleBdbDecouplerAnimation.Decouple
								action = on
							}
						}
						MAS_ACTION_GROUP
						{
							name = SM Cargo Bays AG
							id = 19
							ACTION
							{
								name = SM Cargo Bay
								part = bluedog_Apollo_Block2_ServiceModule
								module = ModuleAnimateGeneric
								action = toggle
							}
						}
					}
				}
			}
		}
	}

	MODULE
	{
		name = ModuleIVASwitch
		internalName = bdbKP0110internal
	}
}
